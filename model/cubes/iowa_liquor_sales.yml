cubes:
  - name: iowa_liquor_sales
    sql_table: dbt_dev_diageo.iowa_liquor_sales
    pre_aggregations:
      # Pre-Aggregations definitions go here
      # Learn more here: https://cube.dev/docs/caching/pre-aggregations/getting-started
    joins: []
    measures:
      - name: invoice_count
        sql: invoice_and_item_number
        type: count
      - name: bottles_sold
        sql: bottles_sold
        type: sum
      - name: volume_sold_liters
        sql: volume_sold_liters
        type: sum
      - name: sale_dollars
        sql: sale_dollars
        type: sum
        # Invoice Count
      - name: average_sale_dollars_per_invoice
        sql: "ROUND({sale_dollars} / {invoice_count},2)"
        type: number
      - name: average_bottles_sold_per_invoice
        sql: "ROUND({bottles_sold} / {invoice_count},2)"
        type: number
        # Bottles Sold
      - name: average_sale_dollars_per_bottle
        sql: "ROUND({sale_dollars} / {bottles_sold},2)"
        type: number
      - name: average_liter_per_bottle
        sql: "ROUND({volume_sold_liters} / {bottles_sold},2)"
        type: number
        # Liters Sold
      - name: average_sale_dollars_per_liter
        sql: "ROUND({sale_dollars} / {volume_sold_liters},2)"
        type: number
        


    dimensions:
      - name: invoice_and_item_number
        sql: invoice_and_item_number
        type: string
        primary_key: true
      - name: store_number
        sql: store_number
        type: string
      - name: store_name
        sql: store_name
        type: string
      - name: address
        sql: address
        type: string
      - name: city
        sql: city
        type: string
      - name: category_name
        sql: category_name
        type: string
      - name: item_number
        sql: item_number
        type: string
      - name: item_description
        sql: item_description
        type: string
      - name: state_bottle_retail
        sql: state_bottle_retail
        type: string
      - name: brand_name
        sql: brand_name
        type: string
      - name: date
        sql: date
        type: time
